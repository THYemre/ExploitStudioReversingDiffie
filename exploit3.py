import random
import math
from Crypto.Util import number
from pwn import *

app = process(['python','exercise-diffie.py'])
app.recv()
app.recv()
g = int(app.recv().split('=')[1]) # g
p = int(app.recv().split('=')[1])
AliceKey = int(app.recv().split(':')[1])
Bobkey = int(app.recv().split(':')[1])
y = random.randint(0,p-1)
while True:
	x = random.randint(0,p-1)
	key = pow(g,x,p)
	if key == AliceKey:
		alicePriv = pow(Bobkey,x,p)
		app.recv()
		app.sendline(str(alicePriv))
		result = app.recv()
		results = result.split(' ')[3]
		results += " " + result.split(' ')[4]
		results += " " + result.split(' ')[5]
		print results
		app.close()
		break

app.close()

